(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{89:function(e,t,r){"use strict";r.r(t),r.d(t,"frontMatter",(function(){return i})),r.d(t,"metadata",(function(){return s})),r.d(t,"rightToc",(function(){return u})),r.d(t,"default",(function(){return l}));var n=r(3),a=r(7),o=(r(0),r(93)),i={id:"aws-azdo",title:"AWS azure-devops"},s={unversionedId:"xks/operator-guide/aws-azdo",id:"xks/operator-guide/aws-azdo",isDocsHomePage:!1,title:"AWS azure-devops",description:"In this scenario, the customer is using Azure DevOps for source control and continuous delivery and use EKS to deliver services.",source:"@site/docs/xks/operator-guide/aws-azdo.md",slug:"/xks/operator-guide/aws-azdo",permalink:"/docs/xks/operator-guide/aws-azdo",editUrl:"https://github.com/xenitab/xenitab.github.io/edit/main/docs/xks/operator-guide/aws-azdo.md",version:"current",sidebar:"docs",previous:{title:"Blue Green Clusters",permalink:"/docs/xks/operator-guide/blue-green"},next:{title:"XKF on Github",permalink:"/docs/xks/operator-guide/github"}},u=[{value:"Terraform",id:"terraform",children:[]},{value:"GitOps user",id:"gitops-user",children:[]}],c={rightToc:u};function l(e){var t=e.components,r=Object(a.a)(e,["components"]);return Object(o.b)("wrapper",Object(n.a)({},c,r,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"In this scenario, the customer is using Azure DevOps for source control and continuous delivery and use EKS to deliver services.\nWe also have support for GitHub."),Object(o.b)("p",null,"The main difference from a Azure DevOps point of view is that we use the AWS service connection.\nFirst you need to install the addon to Azure DevOps using the Azure marketplace,\nyou can find more information how ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.aws.amazon.com/vsts/latest/userguide/getting-started.html"}),"here"),"."),Object(o.b)("p",null,"We will use two users when talking to AWS, one for our terraform pipelines and one for\nour gitops flow where we use Elastic Container Registry (ECR) to store the container images."),Object(o.b)("h2",{id:"terraform"},"Terraform"),Object(o.b)("p",null,"All this is possible to solve using Terraform but we currently don't have any terraform module to handle it so for now you can read about the manual steps."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Create a IAM user",Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},"Tip put both these users under a specific path, for example CI"),Object(o.b)("li",{parentName:"ul"},"Save the access key in a safe place"))),Object(o.b)("li",{parentName:"ul"},"Attach IAM policy",Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},"AmazonEKSClusterPolicy"),Object(o.b)("li",{parentName:"ul"},"AdministratorAccess")))),Object(o.b)("h2",{id:"gitops-user"},"GitOps user"),Object(o.b)("p",null,"In our GitOps pipelines using flux we need to be able to push and delete images in ECR.\nSo very similar to how we created the terraform user:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Create a IAM user",Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},"Tip put both these users under a specific path, for example CI"),Object(o.b)("li",{parentName:"ul"},"Save the credentials in a safe place"))),Object(o.b)("li",{parentName:"ul"},"Attach IAM policy",Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},"AmazonEC2ContainerRegistryFullAccess")))))}l.isMDXComponent=!0},93:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return m}));var n=r(0),a=r.n(n);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var c=a.a.createContext({}),l=function(e){var t=a.a.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},p=function(e){var t=l(e.components);return a.a.createElement(c.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},d=a.a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,i=e.parentName,c=u(e,["components","mdxType","originalType","parentName"]),p=l(r),d=n,m=p["".concat(i,".").concat(d)]||p[d]||b[d]||o;return r?a.a.createElement(m,s(s({ref:t},c),{},{components:r})):a.a.createElement(m,s({ref:t},c))}));function m(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,i=new Array(o);i[0]=d;var s={};for(var u in t)hasOwnProperty.call(t,u)&&(s[u]=t[u]);s.originalType=e,s.mdxType="string"==typeof e?e:n,i[1]=s;for(var c=2;c<o;c++)i[c]=r[c];return a.a.createElement.apply(null,i)}return a.a.createElement.apply(null,r)}d.displayName="MDXCreateElement"}}]);